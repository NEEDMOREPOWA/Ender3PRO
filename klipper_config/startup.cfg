[gcode_macro STARTUP]
variable_has_run: 0
gcode:
    {% if has_run == 0 %}
        SET_LED LED=LED RED=0.0 GREEN=0.0 BLUE=1.0  # Start with blue
        G28  # Home all axes

        # Gradual transition from blue to white
        SET_LED LED=LED RED=0.2 GREEN=0.2 BLUE=1.0
        G4 P1000
        SET_LED LED=LED RED=0.4 GREEN=0.4 BLUE=1.0
        G4 P1000
        SET_LED LED=LED RED=0.6 GREEN=0.6 BLUE=1.0
        G4 P1000
        SET_LED LED=LED RED=0.8 GREEN=0.8 BLUE=1.0
        G4 P1000
        SET_LED LED=LED RED=1.0 GREEN=1.0 BLUE=1.0  # Fully white (homing complete)

        SET_GCODE_VARIABLE MACRO=STARTUP VARIABLE=has_run VALUE=1
    {% endif %}